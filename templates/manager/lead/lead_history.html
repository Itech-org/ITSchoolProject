{% extends 'manager/base_manager.html' %}

{% load static %}
{% load crispy_forms_tags %}
{% load bootstrap4 %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/services_page.css' %}" />
{% endblock %}

{% block title %}
<p class="main-header__page-information">История лида</p>
{% endblock %}

{% block content %}
<main>
    <div class="p-3">
<form method="post" action="{% url 'manager_school:lead_history' lead_id=lead.id %}">
    {% csrf_token %}
    <div class="d-flex flex-column">
        {% for field in lead_form %}
        <div class="d-flex">
            {{ field }}
            <div class="p-1 text-secondary">{{ field.label }}</div>
        </div>
        {% endfor %}
    </div>
    <button class="btn btn-primary mb-3" type="submit">Сохранить</button>
</form>
<hr>
<div class="alert alert-dark">Разговоры</div>
<hr>
<div class="d-flex flex-wrap">
    {% for conversation in conversations %}
    <div class="card mr-3 mb-3">
        <div class="card-header {% if conversation.status == 'Сall back' %}bg-warning{% elif conversation.status == 'Ready' %}bg-success{% elif conversation.status == 'Denial' %}bg-danger{% else %}alert-primary{% endif%}">{{ conversation.date }}</div>
        <div class="card-body">
            <div class="alert alert-light p-1 mr-2">{{ conversation.theses_of_conversation }}</div>
            <div class="alert alert-light p-1 mr-2">{{ conversation.status }}</div>
        </div>
    </div>
    {% endfor %}
</div>
<hr>
<div class="alert alert-dark">Добавить разговор</div>
<hr>
<form class="needs-validation mb-4" method="post" action="{% url 'manager_school:add_req_conversation' lead_id=lead.id %}">
    {% csrf_token %}
    <div class="form-row">
        <div class="d-none">{{ conversation_form.request }}</div>
        <div class="p-1">{{conversation_form.date.label}}</div>
        <div class="d-flex">{{conversation_form.date}}</div>

        <div class="p-1">{{conversation_form.status.label}}</div>
        <div class="d-flex">{{conversation_form.status}}</div>
    </div>
    <div class="mb-2 ">{{conversation_form.theses_of_conversation.label}}</div>
    <div class="form-row">
        <div class="col-md-10 mb-3">
            <div class="d-flex">{{conversation_form.theses_of_conversation}}</div>
        </div>
    </div>
    <div class="form-row">

    </div>
    <button class="btn btn-primary" type="submit">Добавить разговор</button>
</form></div></main>
{% endblock %}